use flvtest
use collections.list
use collections.queue
use collections.heap
use collections.set

test "queue-more" -> do:
  let q0 = queueEmpty()
  let q1 = queuePushAll(q0, rangeInt(0, 3))
  assertEq(queueSize(q1), 3)?
  assertEq(length(queueToList(q1)), 3)?
  assertTrue(isSome(queuePeek(q1)))?
  let p0 = queuePopOr(q0, 9)
  assertEq(p0.value, 9)?
  assertEq(queuePeekOr(q0, 8), 8)?

test "heap-more" -> do:
  let h = heapFromList(Cons(3, Cons(1, Cons(2, Nil))))
  assertEq(heapSize(h), 3)?
  assertEq(heapMinOr(h, 9), 1)?
  assertEq(length(heapToSortedList(h)), 3)?
  let p = heapPopOr(heapEmpty(), 9)
  assertEq(p.value, 9)?
  assertEq(heapPeekOr(heapEmpty(), 8), 8)?
  let h2 = heapInsertAll(Cons(4, Nil), h)
  assertEq(heapSize(h2), 4)?

test "set-more" -> do:
  let a = setAdd(setAdd(setEmpty(), 1), 2)
  let b = setAdd(setAdd(setEmpty(), 2), 3)
  assertEq(setSize(setUnion(a, b)), 3)?
  assertEq(setSize(setIntersect(a, b)), 1)?
  assertEq(setSize(setDiff(a, b)), 1)?
  let xs = Cons(1, Cons(2, Nil))
  let s0 = setFromList(xs)
  let s1 = setAddAll(setEmpty(), xs)
  assertTrue(setEquals(s0, s1))?
  assertTrue(setIsSubset(a, setUnion(a, b)))?
